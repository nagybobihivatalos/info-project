<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shuffle.com Style Blackjack</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0b0e11;
            --panel: #1a212a;
            --accent: #00ff59;
            --blue: #3b82f6;
            --red: #ff3e3e;
            --text: #ffffff;
            --card-w: 95px;
            --card-h: 135px;
        }

        * { box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: var(--text); margin: 0; overflow-x: hidden; }

        /* HEADER */
        .top-bar {
            padding: 15px 30px;
            background: var(--panel);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #2d3748;
        }

        .balance-display {
            background: #0d1217;
            padding: 10px 20px;
            border-radius: 10px;
            border: 1px solid #334155;
            font-weight: 800;
        }
        .balance-display span { color: var(--accent); margin-right: 5px; }

        /* GAME TABLE */
        .table-area {
            height: calc(100vh - 70px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            padding: 40px 20px;
        }

        .hand {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            min-height: 180px;
        }

        .score-pill {
            background: rgba(0,0,0,0.6);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            border: 1px solid #334155;
            color: #94a3b8;
            transition: 0.3s;
        }
        .score-pill.active { color: var(--blue); border-color: var(--blue); }

        .cards-row {
            display: flex;
            justify-content: center;
            gap: -20px; /* Enyhe átfedés */
        }

        /* MODERN CARD ANIMATION */
        .card {
            width: var(--card-w);
            height: var(--card-h);
            background: white;
            border-radius: 8px;
            color: #1a212a;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 8px;
            position: relative;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            animation: slideIn 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
            font-weight: 800;
        }

        @keyframes slideIn {
            from { transform: translateY(-200px) rotate(-15deg); opacity: 0; }
            to { transform: translateY(0) rotate(0deg); opacity: 1; }
        }

        .card.hidden {
            background: linear-gradient(135deg, #2d3748, #1a212a);
            border: 2px solid #334155;
        }
        .card.red { color: var(--red); }
        .card-suit { font-size: 2.5rem; align-self: center; }

        /* BETTING BOX */
        .controls-box {
            background: var(--panel);
            padding: 24px;
            border-radius: 20px;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.6);
            border: 1px solid #2d3748;
        }

        .input-group {
            display: flex;
            background: #0d1217;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #334155;
            overflow: hidden;
        }

        .input-group input {
            background: transparent;
            border: none;
            color: white;
            padding: 15px;
            flex: 1;
            font-size: 1.1rem;
            font-weight: 700;
            outline: none;
        }

        .input-group button {
            background: #2d3748;
            color: #94a3b8;
            border: none;
            padding: 0 15px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 800;
        }

        .input-group button:hover { color: white; }

        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .main-btn {
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-weight: 800;
            cursor: pointer;
            text-transform: uppercase;
            transition: 0.2s;
        }

        .deal { background: var(--accent); color: #000; grid-column: span 2; }
        .hit { background: var(--blue); color: white; }
        .stand { background: #334155; color: white; }

        .main-btn:disabled { opacity: 0.2; cursor: not-allowed; transform: none !important; }
        .main-btn:hover:not(:disabled) { transform: translateY(-3px); filter: brightness(1.1); }

        /* RESULT OVERLAY */
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.85);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .res-text { font-size: 5rem; font-weight: 900; letter-spacing: -2px; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div style="font-weight: 900; font-size: 1.4rem;">SHUFFLE <span style="color:var(--accent)">BJ</span></div>
        <div class="balance-display"><span id="currency">USD</span><span id="moneyText">5000.00</span></div>
    </div>

    <div class="table-area">
        <div class="hand">
            <div class="score-pill" id="dealerScore">DEALER</div>
            <div class="cards-row" id="dealerCards"></div>
        </div>

        <div class="hand">
            <div class="cards-row" id="playerCards"></div>
            <div class="score-pill active" id="playerScore">PLAYER</div>
        </div>

        <div class="controls-box">
            <div class="input-group">
                <input type="number" id="betInput" value="100">
                <button onclick="adjustBet(0.5)">1/2</button>
                <button onclick="adjustBet(2)">2x</button>
                <button onclick="maxBet()">MAX</button>
            </div>
            <div class="btn-grid">
                <button class="main-btn deal" id="dealBtn" onclick="startHand()">Deal</button>
                <button class="main-btn hit" id="hitBtn" onclick="hit()" disabled>Hit</button>
                <button class="main-btn stand" id="standBtn" onclick="stand()" disabled>Stand</button>
            </div>
        </div>
    </div>

    <div class="overlay" id="overlay">
        <div class="res-text" id="resMsg">WIN</div>
        <div id="resPrize" style="color:var(--accent); font-size: 2rem; font-weight: 700;">+$200</div>
    </div>

<script>
    let money = 5000, bet = 0, deck = [], pHand = [], dHand = [], isPlaying = false;
    const suits = ['♠','♥','♦','♣'], ranks = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];

    function createDeck() {
        let d = [];
        suits.forEach(s => ranks.forEach(r => d.push({r, s, red: (s==='♥'||s==='♦')})));
        return d.sort(() => Math.random() - 0.5);
    }

    function getVal(hand) {
        let v = 0, a = 0;
        hand.forEach(c => {
            if(['J','Q','K'].includes(c.r)) v += 10;
            else if(c.r==='A') { v += 11; a++; }
            else v += parseInt(c.r);
        });
        while(v > 21 && a > 0) { v -= 10; a--; }
        return v;
    }

    function renderCard(card, hidden = false) {
        if(hidden) return `<div class="card hidden"></div>`;
        return `<div class="card ${card.red ? 'red' : ''}">
            <div>${card.r}</div>
            <div class="card-suit">${card.s}</div>
            <div style="transform:rotate(180deg)">${card.r}</div>
        </div>`;
    }

    async function startHand() {
        bet = parseInt(document.getElementById('betInput').value);
        if(bet > money || bet <= 0) return;

        money -= bet;
        updateMoney();
        isPlaying = true;
        deck = createDeck();
        pHand = []; dHand = [];
        
        document.getElementById('playerCards').innerHTML = '';
        document.getElementById('dealerCards').innerHTML = '';
        document.getElementById('dealBtn').disabled = true;

        // Szekvenciális osztás (Lassú és modern)
        await addCard('p'); await sleep(400);
        await addCard('d'); await sleep(400);
        await addCard('p'); await sleep(400);
        await addCard('d', true);

        document.getElementById('hitBtn').disabled = false;
        document.getElementById('standBtn').disabled = false;

        if(getVal(pHand) === 21) stand();
    }

    async function addCard(target, hidden = false) {
        const card = deck.pop();
        if(target === 'p') {
            pHand.push(card);
            const el = document.getElementById('playerCards');
            el.innerHTML += renderCard(card);
            document.getElementById('playerScore').textContent = getVal(pHand);
        } else {
            dHand.push(card);
            const el = document.getElementById('dealerCards');
            el.innerHTML += renderCard(card, hidden);
        }
    }

    async function hit() {
        await addCard('p');
        if(getVal(pHand) >= 21) stand();
    }

    async function stand() {
        document.getElementById('hitBtn').disabled = true;
        document.getElementById('standBtn').disabled = true;

        // Dealer felfedi a lapot
        document.getElementById('dealerCards').innerHTML = dHand.map(c => renderCard(c)).join('');
        document.getElementById('dealerScore').textContent = getVal(dHand);

        while(getVal(dHand) < 17) {
            await sleep(800);
            await addCard('d');
            document.getElementById('dealerScore').textContent = getVal(dHand);
        }
        
        finish();
    }

    function finish() {
        const p = getVal(pHand), d = getVal(dHand);
        let win = 0, msg = "";

        if(p > 21) { msg = "BUST"; win = 0; }
        else if(d > 21 || p > d) { msg = "WINNER"; win = bet * 2; }
        else if(p === d) { msg = "PUSH"; win = bet; }
        else { msg = "DEALER"; win = 0; }

        money += win;
        showResult(msg, win);
    }

    function showResult(m, w) {
        const ov = document.getElementById('overlay');
        document.getElementById('resMsg').textContent = m;
        document.getElementById('resMsg').style.color = w > bet ? 'var(--accent)' : (w === 0 ? 'var(--red)' : 'white');
        document.getElementById('resPrize').textContent = w > 0 ? `+$${w.toFixed(2)}` : `-$${bet.toFixed(2)}`;
        
        ov.style.display = 'flex';
        setTimeout(() => {
            ov.style.display = 'none';
            document.getElementById('dealBtn').disabled = false;
            document.getElementById('playerScore').textContent = "PLAYER";
            document.getElementById('dealerScore').textContent = "DEALER";
            updateMoney();
        }, 2500);
    }

    function adjustBet(m) { document.getElementById('betInput').value = Math.floor(document.getElementById('betInput').value * m); }
    function maxBet() { document.getElementById('betInput').value = Math.floor(money); }
    function updateMoney() { document.getElementById('moneyText').textContent = money.toFixed(2); }
    function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
    
    updateMoney();
</script>
</body>
</html>
